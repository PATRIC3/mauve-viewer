!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("d3"));else if("function"==typeof define&&define.amd)define(["d3"],e);else{var n="object"==typeof exports?e(require("d3")):e(t.d3);for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}(window,function(t){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/dist/",n(n.s=6)}([function(t,e){t.exports={schemeCategory20:["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"]}},function(t,e,n){"use strict";n.r(e),n.d(e,"default",function(){return c});var r=n(0);function o(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ele=e.ele,this.data=e.data,this.d3=e.d3,this.init()}return function(t,e,n){e&&a(t.prototype,e),n&&a(t,n)}(t,[{key:"init",value:function(){console.log("data",this.data),this.render(this.d3,this.data)}},{key:"render",value:function(t,e){var n=this.getGenomeRegions(e),a=Object.keys(n).length,c=n[1].length,i=Math.max.apply(Math,o([].concat.apply([],e).map(function(t){return t.end})))+100;t.select("svg").remove();var u,l=t.select("#chart").append("svg").attr("width",1e3).attr("height",165*a),s=+l.attr("width"),f=+l.attr("height"),d=t.zoom().scaleExtent([1,150]).translateExtent([[-2e3,0],[s+90,f+100]]).on("zoom",function(){for(var e=t.event.transform.rescaleX(y[2]),n=0;n<h.length;n++){var r=v[n],o=h[n],a=y[n];r.call(o.scale(t.event.transform.rescaleX(a)))}var c=t.event.sourceEvent;c&&"wheel"!==c.type&&"click"!==c.type?"mousemove"===t.event.sourceEvent.type&&t.selectAll(".region").attr("x",function(t){return e(t.start)}):t.selectAll(".region").attr("x",function(t){return e(t.start)}).attr("width",function(t){return e(t.end)-e(t.start)});t.selectAll("path.lcb-line").attr("d",function(t){var n=t.map(function(t){return{start:t.start,end:t.end,x:e(t.start)+(e(t.end)-e(t.start))/2,y:t.y}});return S(n)}),t.selectAll(".region").on("mousemove",null).on("mouseover",null).on("mouseenter",null).on("mouseleave",null).on("mouseout",null),C(e)});l.on("dblclick.zoom",null);for(var p=140,h=[],v=[],y=[],m=0;m<a;m++){u=t.scaleLinear().domain([0,i]).range([0,s+1]);var g=t.axisBottom(u).ticks((s+2)/(f+2)*10).tickSize(10),b=l.append("g").attr("class","axis axis-x-".concat(m)).call(g).attr("transform","translate(0, ".concat(20+m*(p+0),")"));l.append("text").attr("x",10).attr("y",20+m*p-2).text(n[m+1][0].name).attr("font-family","sans-serif").attr("font-size","10px").attr("fill","#aaaaaa"),h.push(g),v.push(b),y.push(u)}for(var x=50,k=20,w=function(t){var e=n[t];l.select("g").append("g").attr("class","track track-".concat(t)).selectAll("rect").data(e).enter().append("rect").attr("class",function(e){return"region region-track-".concat(t," region-").concat(e.id," group-").concat(e.groupID)}).attr("x",function(t){return u(t.start)}).attr("y",function(e){return z(t,e.strand)}).attr("width",function(t){return u(t.end-t.start)}).attr("height",k).attr("stroke","#fffff").attr("fill",function(t){return r.schemeCategory20[t.groupID%c%20]})},j=1;j<=a;j++)w(j);for(var A=[],E=1;E<=a;E++){var O=z(E,"-"),_=l.append("line").attr("class","hover-line").style("stroke","#222").attr("y1",O-20).attr("y2",O+65);A.push(_)}C(u);var M=[];e.forEach(function(t){var e=[];t.forEach(function(t){var n=t.lcb_idx-1;e.push({start:t.start,end:t.end,x:u(t.start)+(u(t.end)-u(t.start))/2,y:20+z(n+1,t.strand)+k/2})}),M.push(e)});var S=t.line().x(function(t){return t.x}).y(function(t){return t.y});function C(e){var n=e,r=A;l.selectAll(".region").on("mousemove",function(e){var o=e.groupID,a=t.mouse(this)[0],c=e.lcb_idx,i=e.strand,u=a-n(e.start);r[c-1].attr("x1",a).attr("x2",a),l.selectAll(".group-".concat(o)).each(function(t){var e;t.lcb_idx!==c&&(e=i!==t.strand?n(t.end)-u:n(t.start)+u,r[t.lcb_idx-1].attr("x1",e).attr("x2",e))})}),l.selectAll(".region").on("mouseover",function(t){for(var e=0;e<r.length;e++)r[e].attr("opacity",1)}).on("mouseout",function(t){for(var e=0;e<r.length;e++)r[e].attr("opacity",0)})}function z(t,e){return("-"===e?x+k:x)+(t-1)*p}M.forEach(function(t,e){l.datum(t).insert("path",":first-child").attr("class","lcb-line").attr("d",S(t)).attr("stroke-width",1).attr("stroke",r.schemeCategory20[e%20]).attr("fill","none")}),t.select("#reset-btn").on("click",function(){d.transform(l,t.zoomIdentity)}),l.call(d),l.selectAll(".hover-line").on("contextmenu",function(){t.event.preventDefault(),showContextMenu.bind(this)()}),l.selectAll(".region").on("contextmenu",function(e,n){t.event.preventDefault(),showContextMenu.bind(this)()})}},{key:"getSharedLCBs",value:function(t){var e=Math.max.apply(Math,o(t.map(function(t){return t.length})));return t.filter(function(t){return t.length===e})}},{key:"getGenomeRegions",value:function(t){var e={},n=0;return t.forEach(function(t,r){t.forEach(function(t){n+=1,t.id=n,t.groupID=r;var o=t.lcb_idx;o in e?e[o].push(t):e[o]=[t]})}),e}}]),t}()},function(e,n){e.exports=t},,,,function(t,e,n){n(1),t.exports=n(2)}])});
//# sourceMappingURL=mv-bundle.js.map