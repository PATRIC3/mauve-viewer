{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./src/colors.js","webpack:///./src/consts.js","webpack:///./src/track.js","webpack:///./src/track-ctrl.js","webpack:///./src/backbone.js","webpack:///./src/mauve-viewer.js"],"names":["root","factory","exports","module","define","amd","a","i","window","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","schemeCategory20","marginTop","trackOffset","yPosOffset","lcbHeight","track_Track","Track","params","_classCallCheck","this","d3","svg","hidden","id","label","width","xLength","regions","yPos","render","x","xAxis","gX","_createClass","hiddenTrack","scaleLinear","domain","range","axisBottom","ticks","tickSize","append","attr","concat","text","addRegions","_this","numOfLCBs","length","select","selectAll","data","enter","groupID","start","_getRegionYPos","strand","end","colors","_this2","g","scale","event","transform","rescaleX","trackIdx","strandDirection","btnStyle","track_ctrl_TrackCtrl","TrackCtrl","track_ctrl_classCallCheck","container","trackCount","ctrls","isReference","onMoveUp","onMoveDown","onSetReference","onHide","onShow","init","track_ctrl_createClass","destroy","mvPos","querySelector","getBoundingClientRect","relativeTop","top","ele","node","document","createElement","setAttribute","style","left","height","position","_addMainButtons","appendChild","_this$ctrls","_getButtons","upBtn","downBtn","refBtn","hideBtn","classList","add","title","innerHTML","disabled","onclick","moveTrackUp","hideTrack","refTrack","moveTrackDown","showBtn","showTrack","_selectNewRef","_getShowButton","console","log","querySelectorAll","forEach","remove","oldID","newID","newCtrlWasActive","oldCtrl","newCtrl","contains","backbone_BackBone","BackBone","backbone_classCallCheck","backbone_createClass","midSets","lcbs","lcbMids","push","y","lcb_idx","lineFunction","line","set","datum","insert","newScale","map","mauve_viewer_MauveViewer","MauveViewer","_ref","labels","mauve_viewer_classCallCheck","hiddenTracks","_this$getGenomeRegion","getGenomeRegions","regCount","lcbCount","genomeRegions","keys","setReference","rendered","Math","max","apply","_toConsumableArray","region","zoom","scaleExtent","translateExtent","on","srcEvent","sourceEvent","xScales","tracks","rescaleAxis","type","backbone","resetHover","filter","ctrlKey","zoomIdentity","axises","gXs","isHidden","includes","track","hoverLines","getRegionYPos","lines","xPos","mouse","hoverStrand","relXPos","each","nextXPos","swapID","swapTrack","swapBackbones","lcb","sort","b","noRerender","flipped","splice","indexOf","maxRows","regionID","lcbID","index","regionCount"],"mappings":"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","file":"mauve-viewer.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n","\nconst schemeCategory20 = [\n    '#1f77b4',\n    '#aec7e8',\n    '#ff7f0e',\n    '#ffbb78',\n    '#2ca02c',\n    '#98df8a',\n    '#d62728',\n    '#ff9896',\n    '#9467bd',\n    '#c5b0d5',\n    '#8c564b',\n    '#c49c94',\n    '#e377c2',\n    '#f7b6d2',\n    '#7f7f7f',\n    '#c7c7c7',\n    '#bcbd22',\n    '#dbdb8d',\n    '#17becf',\n    '#9edae5'\n]\n\nmodule.exports =  {\n    schemeCategory20\n}","\n\n\nexport const marginTop = 20;     // margin of canvas top\nexport const trackOffset = 100; // distance between axises\nexport const hideTrackOffset = 35;\nexport const yPosOffset = 30;   // distance of regions from x-axis\nexport const lcbHeight = 20;    // height of regions (rectangles)\n\n\n\nexport const container = `\n    <div class=\"mauve-viewer\" style=\"position: relative;\">\n        <div class=\"mv-header\" style=\"text-align: left;\">\n            <h4 class=\"title\">Mauve Viewer (Alpha)</h4>\n            <div class=\"help-text\">\n                <b>Tips:</b> click and drag to pan; use ctrl-scroll or double click to zoom.\n            </div><br>\n            <button class=\"reset-btn\">Reset</button><br>\n        </div>\n        <br>\n        <div class=\"mv-chart\">\n            <svg></svg>\n\n            <div style=\"position: relative;\">\n                <div class=\"mv-context-menu\" style=\"display: none;\">\n                    <ul>\n                        <li id=\"nucleotide-align\">Align by nucleotide</li>\n                        <li>Another item</li>\n                    </ul>\n                </div>\n            </div>\n        </div>\n    </div>`","import {schemeCategory20} from './colors';\nimport {marginTop, trackOffset, yPosOffset, lcbHeight} from './consts';\n\n\nexport class Track {\n\n    constructor(params) {\n        this.d3 = params.d3;\n        this.svg = params.svg;\n\n        this.hidden = params.hidden;\n        this.id = params.id;\n        this.name = params.name;\n        this.label = params.label;\n        this.width = params.width;\n        this.xLength = params.xLength;\n        this.regions = params.regions;\n        this.yPos = params.yPos || marginTop + (this.id - 1) * trackOffset;\n\n        // render and expose axis/scale\n        this.render();\n        this.x;\n        this.xAxis;\n        this.gX\n\n        return this;\n    }\n\n    render() {\n        if (this.hidden) {\n            this.hiddenTrack();\n            return;\n        }\n\n        let d3 = this.d3;\n\n        this.x = d3.scaleLinear()\n            .domain([0, this.xLength])\n            .range([0, this.width + 1]);\n\n        this.xAxis = d3.axisBottom(this.x)\n            .ticks((this.width + 2) / 1700 * 10)\n            .tickSize(10)\n\n        this.gX = this.svg.append(\"g\")\n            .attr(\"class\", `axis axis-x-${this.id}`)\n            .call(this.xAxis)\n            .attr(\"transform\", `translate(0, ${this.yPos})`);\n\n        // add names\n        this.svg.append('text')\n            .attr('x', 0)\n            .attr('y', this.yPos + trackOffset - 5) // -2 padding\n            .text(this.label || this.name)\n            .attr(\"font-family\", \"sans-serif\")\n            .attr(\"font-size\", \"10px\")\n            .attr(\"fill\", '#888');\n\n\n        if (this.regions)\n            this.addRegions(this.regions);\n    }\n\n    addRegions(regions) {\n        let numOfLCBs = regions.length;\n\n        let g = this.svg.select('g')\n            .append('g')\n            .attr('class', d => `track`)\n\n        // add regions\n        g.selectAll('rect')\n            .data(regions)\n            .enter()\n            .append('rect')\n            .attr('class', d => `region region-track-${this.id} group-${d.groupID} region-${d.id}`)\n            .attr('x', d => this.x(d.start))\n            .attr('y', d => this._getRegionYPos(this.id, d.strand))\n            .attr('width', d => this.x(d.end - d.start))\n            .attr('height', lcbHeight)\n            .attr('stroke', '#fffff')\n            .attr('fill', d =>  schemeCategory20[(d.groupID % numOfLCBs) % 20] )\n\n        this.regions = regions;\n    }\n\n    hiddenTrack() {\n        let g = this.svg.select('g')\n            .append('g')\n            .attr('class', d => `hidden-track`)\n\n        g.append('rect')\n            .attr('class', d => `hidden-track track-${this.id}`)\n            .attr('x', 0)\n            .attr('y', d => (this.id-1) * trackOffset )\n            .attr('width', d => 10000)\n            .attr('height', 20)\n            .attr('stroke', '#fffff')\n            .attr('fill', d =>  '#aaa')\n\n        g.append('text')\n            .attr('x', 10)\n            .attr('y', this.yPos - 2) // -2 padding\n            .text(this.label || this.name)\n            .attr(\"font-family\", \"sans-serif\")\n            .attr(\"font-size\", \"10px\")\n            .attr(\"fill\", '#222');\n    }\n\n    rescaleAxis() {\n        if (this.hidden) return;\n        this.gX.call(this.xAxis.scale(this.d3.event.transform.rescaleX(this.x)));\n    }\n\n    _getRegionYPos(trackIdx, strandDirection) {\n        return this.yPos + (strandDirection === '-' ? yPosOffset + lcbHeight : yPosOffset) - marginTop;\n    }\n}\n","\nimport {marginTop, trackOffset, yPos} from './consts';\n\n\nconst btnStyle = 'width: 26px; height: 23px;';\n\nexport class TrackCtrl {\n\n    constructor(params) {\n        this.id = params.id;\n\n        this.container = params.container;\n        this.svg = params.svg;\n        this.trackCount = params.trackCount;\n        this.yPos = params.yPos || marginTop + (this.id - 1) * trackOffset;\n\n        this.ctrls;\n        this.isReference = params.isReference || false;\n        this.hidden;\n\n\n        // control callbacks\n        this.onMoveUp = params.onMoveUp;\n        this.onMoveDown = params.onMoveDown;\n        this.onSetReference = params.onSetReference;\n        this.onHide = params.onHide;\n        this.onShow = params.onShow;\n\n        this.init();\n        return this;\n    }\n\n    init() {\n        this.destroy(); // don't allow more than one controller\n        this.render();\n    }\n\n    render() {\n        let mvPos = this.container.querySelector('.mauve-viewer').getBoundingClientRect(),\n            svgPos = this.svg.getBoundingClientRect(),\n            relativeTop = svgPos.top - mvPos.top;\n\n        // add container\n        let ele = this.node = document.createElement('div');\n        ele.setAttribute('class', `track-ctrl ctrl-${this.id}`);\n        //ele.style.border = \"1px solid black\";\n        ele.style.top = relativeTop  + this.yPos + 5 + 'px';\n        ele.style.left = '-35px';\n        ele.style.width = '25px';\n        ele.style.height = trackOffset + 'px';\n        ele.style.position = 'absolute';\n\n        this._addMainButtons();\n\n        this.container.querySelector('.mauve-viewer').appendChild(ele)\n    }\n\n    _addMainButtons() {\n        let {upBtn, downBtn, hideBtn, refBtn} = this.ctrls = this._getButtons();\n        this.node.appendChild(upBtn);\n        //this.node.appendChild(hideBtn);\n        this.node.appendChild(refBtn);\n        this.node.appendChild(downBtn);\n\n        if (this.isReference)\n            refBtn.classList.add('active');\n    }\n\n    _getButtons() {\n        let upBtn = document.createElement('button');\n        upBtn.title = 'Move this genome up';\n        upBtn.style = btnStyle;\n        upBtn.innerHTML = '▲';\n        upBtn.disabled = this.id === 1 || false;\n        upBtn.onclick = this.moveTrackUp.bind(this)\n\n        let hideBtn = document.createElement('button');\n        hideBtn.title = 'Hide this genome'\n        hideBtn.style = btnStyle;\n        hideBtn.innerHTML = '−';\n        hideBtn.onclick = this.hideTrack.bind(this);\n\n        let refBtn = document.createElement('button');\n        refBtn.title = 'Set reference genome';\n        refBtn.classList.add('ref-btn');\n        refBtn.style = btnStyle;\n        refBtn.innerHTML = 'R';\n        refBtn.onclick = this.refTrack.bind(this);\n\n        let downBtn = document.createElement('button');\n        downBtn.title = 'Move this genome down';\n        downBtn.style = btnStyle;\n        downBtn.innerHTML = '▼';\n        downBtn.disabled = this.id === this.trackCount || false;\n        downBtn.onclick = this.moveTrackDown.bind(this);\n\n        return {upBtn, downBtn, hideBtn, refBtn}\n    }\n\n    _getShowButton() {\n        let showBtn = document.createElement('button');\n        showBtn.title = 'Show this genome';\n        showBtn.classList.add('show-btn');\n        showBtn.style = btnStyle;\n        showBtn.innerHTML = '+';\n        showBtn.onclick = this.showTrack.bind(this);\n        return showBtn;\n    }\n\n\n    moveTrackUp() {\n        this._selectNewRef(this.id, this.id - 1);\n        this.onMoveUp(this.id);\n    }\n\n    moveTrackDown() {\n        this._selectNewRef(this.id, this.id + 1);\n        this.onMoveDown(this.id);\n    }\n\n    hideTrack() {\n        this.node.innerHTML = '';\n        let showBtn = this._getShowButton();\n        this.node.appendChild(showBtn);\n\n        this.hidden = true;\n        this.onHide(this.id);\n    }\n\n    showTrack() {\n        console.log('called show');\n        this.node.innerHTML = '';\n        this._addMainButtons();\n\n        this.hidden = false;\n        this.onShow(this.id);\n    }\n\n    refTrack() {\n        let eles = this.container.querySelectorAll('.ref-btn');\n        eles.forEach(ele => { ele.classList.remove(\"active\"); });\n        this.ctrls.refBtn.classList.add('active');\n\n        this.onSetReference(this.id);\n        this.isReference = true;\n    }\n\n\n    _selectNewRef(oldID, newID) {\n        let oldCtrl = this.container.querySelector(`.ctrl-${oldID} .ref-btn`),\n            newCtrl = this.container.querySelector(`.ctrl-${newID} .ref-btn`);\n\n        let newCtrlWasActive;\n        if (newCtrl.classList.contains('active')) {\n            newCtrl.classList.remove('active');\n            oldCtrl.classList.add('active');\n            newCtrlWasActive = true;\n        }\n\n        if (oldCtrl.classList.contains('active') && !newCtrlWasActive) {\n            oldCtrl.classList.remove('active');\n            newCtrl.classList.add('active');\n        }\n    }\n\n\n    destroy() {\n        let node = this.container.querySelector(`.ctrl-${this.id}`);\n        if (node) node.remove();\n    }\n}\n","\nimport {schemeCategory20} from './colors';\nimport {marginTop, trackOffset, yPosOffset, lcbHeight} from './consts';\n\nexport class BackBone {\n\n    constructor(params) {\n        this.d3 = params.d3;\n        this.svg = params.svg;\n\n        this.data = params.data;\n        this.x = params.scale\n\n        this.render(this.data);\n\n        return this;\n    }\n\n    render(data) {\n        // local (not const)\n        let x = this.x;\n\n        // compute all LCB midpoints as list of objects through backbone\n        let midSets = [];\n        data.forEach((lcbs) => {\n            let lcbMids = [];\n            lcbs.forEach(l => {\n                if (l.hidden) return;\n\n                lcbMids.push({\n                    start: l.start,\n                    end: l.end,\n                    x:  x(l.start) + ( (x(l.end) - x(l.start))  / 2 ) ,\n                    y: marginTop + this._getRegionYPos(l.lcb_idx, l.strand) + (lcbHeight/2)\n                });\n            })\n\n            midSets.push(lcbMids);\n        })\n\n        // draw connections using lineFunction\n        // keep line function for scaling\n        this.lineFunction = this.d3.line()\n            .x(d => d.x)\n            .y(d => d.y)\n\n        midSets.forEach((set, i) => {\n            this.svg.datum(set)\n                .insert(\"path\",\":first-child\")\n                .attr('class', 'lcb-line')\n                .attr(\"d\", this.lineFunction(set))\n                .attr(\"stroke-width\", 1)\n                .attr('stroke', schemeCategory20[i % 20])\n                .attr('fill', 'none')\n\n        })\n\n        return midSets;\n    }\n\n    scale(newScale) {\n        this.svg.selectAll('path.lcb-line')\n            .attr(\"d\", d => {\n                let set = d.map(p => {\n                    return {\n                        start: p.start,\n                        end: p.end,\n                        x: newScale(p.start) + ( (newScale(p.end) - newScale(p.start))  / 2 ),\n                        y: p.y\n                    }\n                })\n\n                return this.lineFunction(set)\n            });\n    }\n\n\n    _getRegionYPos(trackIdx, strandDirection) {\n        return (strandDirection === '-' ? yPosOffset + lcbHeight : yPosOffset) + ((trackIdx-1) * trackOffset);\n    }\n}\n","/**\n * mauve-viewer.js\n *\n * A JS/d3.js Mauve Viewer\n *\n * Author(s): nconrad\n *\n */\n\nimport {Track} from './track';\nimport {TrackCtrl} from './track-ctrl';\nimport {BackBone} from './backbone';\nimport {\n    container,\n    marginTop,\n    trackOffset,\n    hideTrackOffset,\n    yPosOffset,\n    lcbHeight\n} from './consts';\n\n\n\nexport default class MauveViewer {\n    constructor({d3, ele, data, labels}){\n        this.ele = ele;\n        this.data = data;\n        this.d3 = d3;\n\n        this.labels = labels;\n\n        this.hiddenTracks = [];\n\n        this.init();\n    }\n\n    init() {\n        let {regions, regCount, lcbCount} = this.getGenomeRegions(this.data);\n\n        this.genomeRegions = regions;\n        this.trackCount = Object.keys(this.genomeRegions).length;\n\n        // set first genome as reference\n        this.setReference(1, true);\n\n        this.ele.innerHTML = container;\n        this.render();\n\n        this.rendered = true;\n    }\n\n    render() {\n        let d3 = this.d3,\n            data = this.data;\n\n        const genomeRegions = this.genomeRegions;\n        const trackCount = this.trackCount;\n\n        // get highest end value\n        const endMax = Math.max(...[].concat.apply([], data).map(region => region.end));\n        const xLength = endMax + 100;\n\n        // create svg dom element\n        d3.select(this.ele.querySelector('svg')).remove();\n        const svg = d3.select(this.ele.querySelector('.mv-chart')).append(\"svg\")\n            .attr('width', 1000)\n            .attr('height', trackCount * 165)\n\n        const width = +svg.attr(\"width\"),\n            height = +svg.attr(\"height\");\n\n        /**\n         *  ctrl-mousewheel for zoom\n         */\n        let zoom = d3.zoom()\n            .scaleExtent([1, 150])\n            .translateExtent([[-2000, 0], [width + 90, height + 100]])\n            .on(\"zoom\", zoomed)\n            .filter(() => (\n                d3.event.ctrlKey ||\n                d3.event.type === 'mousedown' ||\n                d3.event.type == 'dblclick'\n            ))\n\n        svg.call(zoom);\n\n        d3.select(this.ele.querySelector('.reset-btn'))\n            .on(\"click\", reset);\n\n        /**\n         *  create tracks (axises, scales, gXs)\n         */\n        let axises = [],\n            gXs = [],\n            xScales = [],\n            tracks = [];\n\n        let yPos = marginTop;\n        for (let id = 1; id <= trackCount; id++) {\n            let isHidden = this.hiddenTracks.includes(id);\n            yPos += id === 1 ? 0 : (isHidden ? hideTrackOffset : trackOffset);\n\n            let name = genomeRegions[id][0].name,\n                label = this.labels ? this.labels[name] : '';\n\n            let track = new Track({\n                d3, yPos, svg, id, name, label,\n                width, xLength,\n                hidden: isHidden,\n                regions: genomeRegions[id]\n            })\n\n            axises.push(track.xAxis);\n            gXs.push(track.gX);\n            xScales.push(track.x);\n\n            tracks.push(track);\n\n            // only create track ctrls once\n            if (this.rendered) continue;\n\n            new TrackCtrl({\n                id, yPos, height, container: this.ele,\n                svg: this.ele.querySelector('svg'),\n                trackCount: this.trackCount,\n                isReference: id === 1,\n                onMoveUp: id => { this.moveTrackUp(id) },\n                onMoveDown: id => { this.moveTrackDown(id) },\n                onSetReference: id => { this.setReference(id) },\n                onHide: id => { this.hideTrack(id) },\n                onShow: id => { this.showTrack(id) }\n            })\n        }\n\n        let x = xScales[0]; // x scale is same for all tracks\n\n\n        // add hover cursor lines, initially without x position\n        let hoverLines = [];\n        for (let i=1; i <= trackCount; i++) {\n            let yPos = getRegionYPos(i, '-');\n            let line = svg.append('line')\n                .attr('class', 'hover-line')\n                .style('stroke', '#222' )\n                .attr('y1', marginTop + yPos - 30)\n                .attr('y2', marginTop + yPos + 30)\n\n            hoverLines.push(line);\n        }\n\n        resetHover(x);\n\n        // add backbone of lcb lines\n        let backbone = new BackBone({\n            scale: x, data, d3, svg\n        })\n\n\n        function resetHover(scale) {\n            let x = scale;\n            let lines = hoverLines;\n\n            svg.selectAll('.region').on(\"mousemove\", function(d) {\n                let groupID = d.groupID;\n\n                let xPos = d3.mouse(this)[0],\n                    trackIdx = d.lcb_idx,\n                    hoverStrand = d.strand;\n\n                // need relative position for other tracks\n                let relXPos = xPos - x(d.start);\n\n                // draw cursor line for rect being hovered\n                lines[trackIdx-1]\n                    .attr('x1', xPos)\n                    .attr('x2', xPos)\n\n                // draw cursor line for other rects\n                svg.selectAll(`.group-${groupID}`).each(d => {\n                    // need to skip rect that is being hovered on\n                    if (d.lcb_idx === trackIdx) return;\n\n                    // need to compute relative position based on strand\n                    let nextXPos;\n                    if (hoverStrand !== d.strand) {\n                        nextXPos = x(d.end) - relXPos; // start + positition relative to other blocks\n                    } else {\n                        nextXPos = x(d.start) + relXPos; // start + positition relative to other blocks\n                    }\n\n                    lines[d.lcb_idx-1]\n                        .attr('x1', nextXPos)\n                        .attr('x2', nextXPos)\n                })\n            })\n\n            svg.selectAll('.region')\n                .on(\"mouseover\", function(d) {\n                    for (let i=0; i < lines.length; i++) {\n                        lines[i].attr(\"opacity\", 1.0);\n                    }\n                })\n                .on(\"mouseout\", function(d) {\n                    for (let i=0; i < lines.length; i++) {\n                        lines[i].attr(\"opacity\", 0);\n                    }\n                });\n        }\n\n        function zoomed() {\n            let srcEvent = d3.event.sourceEvent;\n            let newScale = d3.event.transform.rescaleX(xScales[0]);\n\n            // scale each axis\n            for (let i = 0; i < tracks.length; i++) {\n                tracks[i].rescaleAxis();\n            }\n\n            // scale all rectangles\n            if (!srcEvent || srcEvent.type === 'wheel' || srcEvent.type === 'click') {\n                svg.selectAll('.region')\n                    .attr('x', (d) => newScale(d.start))\n                    .attr(\"width\", (d) => newScale(d.end) - newScale(d.start))\n            } else if ((d3.event.sourceEvent.type === 'mousemove')) {\n                svg.selectAll('.region')\n                  .attr(\"x\", (d) => newScale(d.start) );\n            }\n\n            // scale lines\n            backbone.scale(newScale);\n\n            // rescale hover events\n            svg.selectAll('.region')\n                .on(\"mousemove\", null)\n                .on(\"mouseover\", null)\n                .on(\"mouseenter\", null)\n                .on(\"mouseleave\", null)\n                .on(\"mouseout\", null)\n            resetHover(newScale);\n        }\n\n        function reset() {\n            zoom.transform(svg, d3.zoomIdentity);\n        }\n\n        function getRegionYPos(trackIdx, strandDirection ) {\n            return (strandDirection === '-' ? yPosOffset + lcbHeight : yPosOffset) + ((trackIdx-1) * trackOffset);\n        }\n    }\n\n    moveTrackUp(id) {\n        let swapID = id - 1;\n        if (swapID < 1) return;\n\n        this.swapTrack(id, swapID);\n        this.swapBackbones(id, swapID)\n        this.render();\n    }\n\n    moveTrackDown(id) {\n        let swapID = id + 1;\n        if (swapID > this.trackCount) return;\n\n        this.swapTrack(id, swapID);\n        this.swapBackbones(id, swapID)\n        this.render();\n    }\n\n    swapTrack(id, newID) {\n        let swapTrack = this.genomeRegions[newID];\n        this.genomeRegions[newID] = this.genomeRegions[id];\n        this.genomeRegions[id] = swapTrack;\n    }\n\n    swapBackbones(oldID, newID) {\n        this.data.forEach(lcb => {\n            let foundOldRegion = null,\n                foundSwapRegion = null;\n            lcb.forEach(region => {\n                if (region.lcb_idx === oldID)\n                    region.lcb_idx = newID;\n                else if (region.lcb_idx === newID)\n                    region.lcb_idx = oldID;\n            })\n\n            lcb.sort((a, b) => a.lcb_idx - b.lcb_idx)\n        })\n    }\n\n    setReference(id, noRerender) {\n        this.data.forEach(lcb => {\n            let flipped = false;\n\n            // first determine if reference's (region)\n            // strand direction is made positive\n            lcb.forEach(region => {\n                if (region.lcb_idx !== id) return;\n\n                if (region.strand !== '+') {\n                    region.strand = '+';\n                    flipped = true\n                }\n            })\n\n            if (!flipped) return;\n\n            // otherwise, need to flip corresponding regions\n            lcb.forEach(region => {\n                if (region.lcb_idx === id) return;\n                region.strand = region.strand === '-' ? '+' : '-';\n            })\n        })\n\n        if (noRerender) return;\n\n        this.render();\n    }\n\n    hideTrack(id) {\n        console.log('called hide track', id)\n\n        this.data.forEach(lcbs => {\n            lcbs.forEach(region => {\n                if (region.lcb_idx == id)\n                    region.hidden = true;\n            })\n        })\n\n        this.hiddenTracks.push(id);\n        this.render();\n    }\n\n\n    showTrack(id) {\n        console.log('called show track', id)\n        console.log('this.hiddentTracks', this.hiddenTracks)\n\n        this.data.forEach(lcbs => {\n            lcbs.forEach(region => {\n                if (region.lcb_idx == id)\n                    delete region.hidden;\n            })\n        })\n\n        this.hiddenTracks.splice( this.hiddenTracks.indexOf(id));\n        console.log('this.hiddentTracks', this.hiddenTracks)\n        this.render();\n    }\n\n\n\n    // gets lcbs that have entry for every organism\n    // deprecated(?)\n    getSharedLCBs(data) {\n        let maxRows = Math.max( ...data.map(lcb => lcb.length) );\n        let filtered = data.filter(lcbs => lcbs.length === maxRows);\n        return filtered;\n    }\n\n    // gets regions for each organism (index); adding ids\n    // also returns connections of regions\n    getGenomeRegions(lcbs) {\n        let regions = {};\n        let regionID = 0;\n        let lcbID = 0;\n        lcbs.forEach((lcb, groupID) => {\n            //lcb.reverse(); // consider last index reference genome\n            lcbID += 1;\n            lcb.forEach((region) => {\n                // increment/add ids to regions\n                regionID += 1;\n                region.id = regionID;\n                region.groupID = groupID;\n\n                let index = region.lcb_idx;\n                if (index in regions)\n                    regions[index].push(region);\n                else\n                    regions[index] = [region];\n            })\n        })\n\n        return {regions, regionCount: regionID, lcbCount: lcbID};\n    }\n\n\n}\n"],"sourceRoot":""}