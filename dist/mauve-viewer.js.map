{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./src/backbone.js","webpack:///./src/colors.js","webpack:///./src/consts.js","webpack:///./src/container.html","webpack:///./src/cursor.js","webpack:///./src/mauve-viewer.js","webpack:///./src/track-ctrl.js","webpack:///./src/track.js"],"names":["BackBone","params","d3","svg","data","x","scale","render","midSets","forEach","lcbs","lcbMids","l","hidden","push","start","end","y","_getRegionYPos","lcb_idx","strand","lineFunction","line","d","set","i","datum","insert","attr","newScale","selectAll","map","p","trackIdx","strandDirection","schemeCategory20","module","exports","marginTop","trackOffset","hideTrackOffset","yPosOffset","lcbHeight","ctrlPadding","Cursor","container","trackCount","hoverLines","yPos","append","style","resetHover","lines","on","lengthNode","querySelector","ntPosNode","length","clientX","event","clientY","ele","document","elementFromPoint","select","tagName","classList","contains","xPos","mouse","hoverStrand","Math","round","invert","relXPos","groupID","each","nextXPos","innerHTML","relatedTarget","MauveViewer","labels","hiddenTracks","init","getGenomeRegions","regions","genomeRegions","Object","keys","setReference","rendered","initControls","endMax","max","concat","apply","region","xLength","console","log","remove","width","height","zoom","scaleExtent","translateExtent","zoomed","filter","ctrlKey","type","call","reset","axises","gXs","xScales","tracks","id","isHidden","includes","name","label","track","xAxis","gX","isReference","onMoveUp","moveTrackUp","onMoveDown","moveTrackDown","onSetReference","onHide","hideTrack","onShow","showTrack","cursor","backbone","srcEvent","sourceEvent","transform","rescaleX","rescaleAxis","zoomIdentity","swapID","swapTrack","swapBackbones","newID","oldID","lcb","foundOldRegion","foundSwapRegion","sort","a","b","noRerender","flipped","splice","indexOf","maxRows","filtered","regionID","lcbID","index","regionCount","lcbCount","onclick","toggle","evt","dd","target","matches","dds","getElementsByClassName","Array","from","btnStyle","TrackCtrl","ctrls","destroy","mvPos","getBoundingClientRect","svgPos","relativeTop","top","node","createElement","setAttribute","left","position","_addMainButtons","appendChild","_getButtons","upBtn","downBtn","hideBtn","refBtn","add","title","disabled","bind","refTrack","showBtn","_selectNewRef","_getShowButton","eles","querySelectorAll","oldCtrl","newCtrl","newCtrlWasActive","Track","hiddenTrack","scaleLinear","domain","range","axisBottom","ticks","tickSize","tickFormat","format","g","text","addRegions","numOfLCBs","enter"],"mappings":"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","file":"mauve-viewer.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","\nimport {schemeCategory20} from './colors';\nimport {marginTop, trackOffset, yPosOffset, lcbHeight} from './consts';\n\nexport class BackBone {\n\n    constructor(params) {\n        this.d3 = params.d3;\n        this.svg = params.svg;\n\n        this.data = params.data;\n        this.x = params.scale\n\n        this.render(this.data);\n\n        return this;\n    }\n\n    render(data) {\n        // local (not const)\n        let x = this.x;\n\n        // compute all LCB midpoints as list of objects through backbone\n        let midSets = [];\n        data.forEach((lcbs) => {\n            let lcbMids = [];\n            lcbs.forEach(l => {\n                if (l.hidden) return;\n\n                lcbMids.push({\n                    start: l.start,\n                    end: l.end,\n                    x:  x(l.start) + ( (x(l.end) - x(l.start))  / 2 ) ,\n                    y: marginTop + this._getRegionYPos(l.lcb_idx, l.strand) + (lcbHeight/2)\n                });\n            })\n\n            midSets.push(lcbMids);\n        })\n\n        // draw connections using lineFunction\n        // keep line function for scaling\n        this.lineFunction = this.d3.line()\n            .x(d => d.x)\n            .y(d => d.y)\n\n        midSets.forEach((set, i) => {\n            this.svg.datum(set)\n                .insert(\"path\",\":first-child\")\n                .attr('class', 'lcb-line')\n                .attr(\"d\", this.lineFunction(set))\n                .attr(\"stroke-width\", 1)\n                .attr('stroke', schemeCategory20[i % 20])\n                .attr('fill', 'none')\n\n        })\n\n        return midSets;\n    }\n\n    scale(newScale) {\n        this.svg.selectAll('path.lcb-line')\n            .attr(\"d\", d => {\n                let set = d.map(p => {\n                    return {\n                        start: p.start,\n                        end: p.end,\n                        x: newScale(p.start) + ( (newScale(p.end) - newScale(p.start))  / 2 ),\n                        y: p.y\n                    }\n                })\n\n                return this.lineFunction(set)\n            });\n    }\n\n\n    _getRegionYPos(trackIdx, strandDirection) {\n        return (strandDirection === '-' ? yPosOffset + lcbHeight : yPosOffset) + ((trackIdx-1) * trackOffset);\n    }\n}\n","\nconst schemeCategory20 = [\n    '#1f77b4',\n    '#aec7e8',\n    '#ff7f0e',\n    '#ffbb78',\n    '#2ca02c',\n    '#98df8a',\n    '#d62728',\n    '#ff9896',\n    '#9467bd',\n    '#c5b0d5',\n    '#8c564b',\n    '#c49c94',\n    '#e377c2',\n    '#f7b6d2',\n    '#7f7f7f',\n    '#c7c7c7',\n    '#bcbd22',\n    '#dbdb8d',\n    '#17becf',\n    '#9edae5'\n]\n\nmodule.exports =  {\n    schemeCategory20\n}","\n\n\nexport const marginTop = 20;     // margin of canvas top\nexport const trackOffset = 105; // distance between axises\nexport const hideTrackOffset = 35;\nexport const yPosOffset = 30;   // distance of regions from x-axis\nexport const lcbHeight = 22;    // height of regions (rectangles)\nexport const ctrlPadding = 6;\n","module.exports = \"\\n\\n<div class=\\\"mauve-viewer\\\" style=\\\"position: relative;\\\">\\n    <div class=\\\"mv-header\\\" style=\\\"text-align: left;\\\">\\n        <h4 class=\\\"title\\\">Mauve Viewer (Alpha)</h4>\\n        <div class=\\\"help-text\\\">\\n            <b>Tips:</b> click and drag to pan; use ctrl-scroll or double click to zoom.\\n        </div><br>\\n        <button class=\\\"reset-btn\\\">Reset</button>\\n\\n        <div class=\\\"dropdown\\\">\\n            <button class=\\\"opts-btn dd-btn\\\">Options <i class=\\\"caret-down\\\"></i></button>\\n            <div class=\\\"dd-content\\\">\\n                <div>\\n                    <label>\\n                        <input type=\\\"checkbox\\\" name=\\\"fileNames\\\" value=\\\"fileNames\\\" />\\n                        Show File Names\\n                    </label>\\n                </div>\\n                <div>Hide track controls</div>\\n            </div>\\n        </div>\\n\\n        <div class=\\\"cursor-info pull-right\\\">\\n            <span class=\\\"nt-pos\\\">-</span>\\n            LCB Length: <span class=\\\"lcb-length\\\">-</span>\\n        </div>\\n\\n\\n        <br>\\n    </div>\\n    <br>\\n    <div class=\\\"mv-chart\\\">\\n        <svg></svg>\\n\\n        <div style=\\\"position: relative;\\\">\\n            <div class=\\\"mv-context-menu\\\" style=\\\"display: none;\\\">\\n                <ul>\\n                    <li id=\\\"nucleotide-align\\\">Align by nucleotide</li>\\n                    <li>Another item</li>\\n                </ul>\\n            </div>\\n        </div>\\n    </div>\\n</div>\";","// Todo: listen for mousemove on track container\n\nimport {marginTop, yPosOffset, lcbHeight, trackOffset} from './consts';\n\nexport class Cursor {\n\n    constructor(params) {\n        this.container = params.container;\n        this.d3 = params.d3;\n        this.svg = params.svg;\n        this.scale = params.scale;\n        this.trackCount = params.trackCount;\n\n        this.hoverLines = [];\n\n        this.render();\n\n        return this;\n    }\n\n    render() {\n        // draw the track cursor once and update\n        // position for better performance\n        for (let i=1; i <= this.trackCount; i++) {\n            let yPos = this._getRegionYPos(i, '-');\n            let line = this.svg.append('line')\n                .attr('class', 'hover-line')\n                .style('stroke', '#222' )\n                .attr('y1', marginTop + yPos - 30)\n                .attr('y2', marginTop + yPos + 30)\n\n            this.hoverLines.push(line);\n        }\n\n        this.resetHover(this.scale);\n    }\n\n    resetHover(scale) {\n        let svg = this.svg,\n            d3 = this.d3,\n            lines = this.hoverLines;\n\n        svg.selectAll('.track')\n            .on(\"mouseover\", null)\n            .on(\"mousemove\", null)\n            .on(\"mouseout\", null);\n\n        let lengthNode = this.container.querySelector('.lcb-length'),\n            ntPosNode = this.container.querySelector('.nt-pos');\n\n        let x = scale;\n\n        svg.selectAll('.track')\n            .on(\"mouseover\", function(d) {\n                for (let i=0; i < lines.length; i++) {\n                    lines[i].attr(\"opacity\", 1.0)\n                }\n            })\n            .on(\"mousemove\", function() {\n                let clientX = d3.event.clientX,\n                    clientY = d3.event.clientY;\n                let ele = document.elementFromPoint(clientX, clientY);\n                let d = d3.select(ele).data()[0];\n\n                if (!ele) return;\n\n                // ignore non-regions\n                if (ele.tagName !== 'rect' || !d || !('lcb_idx' in d)) {\n                    if (ele.classList.contains('cursor-line')) {\n                        return;\n                    }\n\n                    // if not region, hide cursors\n                    for (let i=0; i < lines.length; i++) {\n                        lines[i].attr(\"opacity\", 0);\n                    }\n                    return;\n                }\n\n                let xPos = d3.mouse(this)[0],\n                    trackIdx = d.lcb_idx,\n                    hoverStrand = d.strand;\n\n                // base xPos on nearest integer in range\n                xPos = x(Math.round(x.invert(xPos)));\n\n                // position relative to lcb\n                let relXPos = xPos - x(d.start);\n\n                // draw cursor line for rect being hovered\n                lines[trackIdx - 1]\n                    .attr('class', 'cursor-line')\n                    .attr('x1', xPos)\n                    .attr('x2', xPos);\n\n                // draw cursor line for other rects\n                let groupID = d.groupID;\n                svg.selectAll(`.group-${groupID}`).each(d => {\n                    // need to skip rect that is being hovered on\n                    if (d.lcb_idx === trackIdx) return;\n\n                    // need to compute relative position based on strand\n                    let nextXPos;\n                    if (hoverStrand !== d.strand) {\n                        nextXPos = x(d.end) - relXPos; // start + positition relative to other blocks\n                    } else {\n                        nextXPos = x(d.start) + relXPos; // start + positition relative to other blocks\n                    }\n\n                    lines[d.lcb_idx-1]\n                        .attr('x1', nextXPos)\n                        .attr('x2', nextXPos)\n                })\n\n                // set cursor-info\n                lengthNode.innerHTML = d.end - d.start + 1;\n                ntPosNode.innerHTML = Math.round(x.invert(xPos));\n            })\n            .on(\"mouseout\", function(d) {\n                // ignore hover on line\n                if (d3.event.relatedTarget &&\n                    d3.event.relatedTarget.classList.contains('cursor-line')) {\n                    return;\n                }\n\n                for (let i=0; i < lines.length; i++) {\n                    lines[i].attr(\"opacity\", 0);\n                }\n\n                lengthNode.innerHTML = '-';\n                ntPosNode.innerHTML = '-';\n            });\n    }\n\n    _getRegionYPos(trackIdx, strandDirection) {\n        return (strandDirection === '-' ? yPosOffset + lcbHeight : yPosOffset) + ((trackIdx-1) * trackOffset);\n    }\n}\n","/**\n * mauve-viewer.js\n *\n * A JS/d3.js Mauve Viewer\n *\n * Author(s): nconrad\n *\n */\n\nimport {Track} from './track';\nimport {TrackCtrl} from './track-ctrl';\nimport {BackBone} from './backbone';\nimport {Cursor} from './cursor';\nimport template from './container.html';\nimport {\n    marginTop,\n    trackOffset,\n    hideTrackOffset,\n    yPosOffset,\n    lcbHeight\n} from './consts';\n\n\n\nexport default class MauveViewer {\n    constructor({d3, ele, data, labels}){\n        this.ele = ele;\n        this.data = data;\n        this.d3 = d3;\n\n        this.labels = labels;\n\n        this.hiddenTracks = [];\n\n        this.init();\n    }\n\n    init() {\n        let {regions} = this.getGenomeRegions(this.data);\n        this.genomeRegions = regions;\n        this.trackCount = Object.keys(this.genomeRegions).length;\n\n        this.setReference(1, true);  // set first genome as reference\n\n        this.ele.innerHTML = template;\n        this.render();\n        this.rendered = true;\n\n        this.initControls(); // add global controls\n    }\n\n    render() {\n        const d3 = this.d3,\n            data = this.data;\n\n        const genomeRegions = this.genomeRegions;\n        const trackCount = this.trackCount;\n\n        // get highest end value\n        const endMax = Math.max(...[].concat.apply([], data).map(region => region.end));\n        const xLength = endMax + 100;\n        console.log('xLength', xLength)\n\n        // create svg dom element\n        d3.select(this.ele.querySelector('svg')).remove();\n        const svg = d3.select(this.ele.querySelector('.mv-chart')).append(\"svg\")\n            .attr('width', 1000)\n            .attr('height', trackCount * 165)\n\n        const width = +svg.attr(\"width\"),\n            height = +svg.attr(\"height\");\n\n        /**\n         *  ctrl-mousewheel for zoom\n         */\n        let zoom = d3.zoom()\n            .scaleExtent([0, xLength/10])\n            .translateExtent([[-width, 0], [width + 100, 0]])\n            .on(\"zoom\", zoomed)\n            .filter(() => (\n                d3.event.ctrlKey ||\n                d3.event.type === 'mousedown' ||\n                d3.event.type == 'dblclick'\n            ))\n\n        svg.call(zoom);\n\n        d3.select(this.ele.querySelector('.reset-btn'))\n            .on(\"click\", reset);\n\n        /**\n         *  create tracks (axises, scales, gXs)\n         */\n        let axises = [],\n            gXs = [],\n            xScales = [],\n            tracks = [];\n\n        let yPos = marginTop;\n        for (let id = 1; id <= trackCount; id++) {\n            let isHidden = this.hiddenTracks.includes(id);\n            yPos += id === 1 ? 0 : (isHidden ? hideTrackOffset : trackOffset);\n\n            let name = genomeRegions[id][0].name,\n                label = this.labels ? this.labels[name] : '';\n\n            let track = new Track({\n                d3, yPos, svg, id, name, label,\n                width, xLength,\n                hidden: isHidden,\n                regions: genomeRegions[id]\n            })\n\n            axises.push(track.xAxis);\n            gXs.push(track.gX);\n            xScales.push(track.x);\n\n            tracks.push(track);\n\n            // only create track ctrls once\n            if (this.rendered) continue;\n\n            new TrackCtrl({\n                id, yPos, height, container: this.ele,\n                svg: this.ele.querySelector('svg'),\n                trackCount: this.trackCount,\n                isReference: id === 1,\n                onMoveUp: id => { this.moveTrackUp(id) },\n                onMoveDown: id => { this.moveTrackDown(id) },\n                onSetReference: id => { this.setReference(id) },\n                onHide: id => { this.hideTrack(id) },\n                onShow: id => { this.showTrack(id) }\n            })\n        }\n\n        let x = xScales[0]; // x scale is same for all tracks\n\n\n        // add hover cursor lines, initially without x position\n        let cursor = new Cursor({\n            d3, trackCount, svg,\n            scale: x,\n            container: this.ele\n        })\n\n        // add backbone of lcb lines\n        let backbone = new BackBone({\n            scale: x, data, d3, svg\n        })\n\n        function zoomed() {\n            let srcEvent = d3.event.sourceEvent;\n            let newScale = d3.event.transform.rescaleX(xScales[0]);\n\n            // scale each axis\n            for (let i = 0; i < tracks.length; i++) {\n                tracks[i].rescaleAxis();\n            }\n\n            // scale all rectangles\n            if (!srcEvent || srcEvent.type === 'wheel' || srcEvent.type === 'click') {\n                svg.selectAll('.region')\n                    .attr('x', (d) => newScale(d.start))\n                    .attr(\"width\", (d) => newScale(d.end) - newScale(d.start))\n            } else if ((d3.event.sourceEvent.type === 'mousemove')) {\n                svg.selectAll('.region')\n                  .attr(\"x\", (d) => newScale(d.start) );\n            }\n\n            // scale lines\n            backbone.scale(newScale);\n\n            cursor.resetHover(newScale);\n        }\n\n        function reset() {\n            zoom.transform(svg, d3.zoomIdentity);\n        }\n    }\n\n    moveTrackUp(id) {\n        let swapID = id - 1;\n        if (swapID < 1) return;\n\n        this.swapTrack(id, swapID);\n        this.swapBackbones(id, swapID)\n        this.render();\n    }\n\n    moveTrackDown(id) {\n        let swapID = id + 1;\n        if (swapID > this.trackCount) return;\n\n        this.swapTrack(id, swapID);\n        this.swapBackbones(id, swapID)\n        this.render();\n    }\n\n    swapTrack(id, newID) {\n        let swapTrack = this.genomeRegions[newID];\n        this.genomeRegions[newID] = this.genomeRegions[id];\n        this.genomeRegions[id] = swapTrack;\n    }\n\n    swapBackbones(oldID, newID) {\n        this.data.forEach(lcb => {\n            let foundOldRegion = null,\n                foundSwapRegion = null;\n            lcb.forEach(region => {\n                if (region.lcb_idx === oldID)\n                    region.lcb_idx = newID;\n                else if (region.lcb_idx === newID)\n                    region.lcb_idx = oldID;\n            })\n\n            lcb.sort((a, b) => a.lcb_idx - b.lcb_idx)\n        })\n    }\n\n    setReference(id, noRerender) {\n        this.data.forEach(lcb => {\n            let flipped = false;\n\n            // first determine if reference's (region)\n            // strand direction is made positive\n            lcb.forEach(region => {\n                if (region.lcb_idx !== id) return;\n\n                if (region.strand !== '+') {\n                    region.strand = '+';\n                    flipped = true\n                }\n            })\n\n            if (!flipped) return;\n\n            // otherwise, need to flip corresponding regions\n            lcb.forEach(region => {\n                if (region.lcb_idx === id) return;\n                region.strand = region.strand === '-' ? '+' : '-';\n            })\n        })\n\n        if (noRerender) return;\n\n        this.render();\n    }\n\n    hideTrack(id) {\n        this.data.forEach(lcbs => {\n            lcbs.forEach(region => {\n                if (region.lcb_idx == id)\n                    region.hidden = true;\n            })\n        })\n\n        this.hiddenTracks.push(id);\n        this.render();\n    }\n\n    showTrack(id) {\n        this.data.forEach(lcbs => {\n            lcbs.forEach(region => {\n                if (region.lcb_idx == id)\n                    delete region.hidden;\n            })\n        })\n\n        this.hiddenTracks.splice( this.hiddenTracks.indexOf(id));\n        this.render();\n    }\n\n    // gets lcbs that have entry for every organism\n    // deprecated(?)\n    getSharedLCBs(data) {\n        let maxRows = Math.max( ...data.map(lcb => lcb.length) );\n        let filtered = data.filter(lcbs => lcbs.length === maxRows);\n        return filtered;\n    }\n\n    // gets regions for each organism (index); adding ids\n    // also returns connections of regions\n    getGenomeRegions(lcbs) {\n        let regions = {};\n        let regionID = 0;\n        let lcbID = 0;\n        lcbs.forEach((lcb, groupID) => {\n            //lcb.reverse(); // consider last index reference genome\n            lcbID += 1;\n            lcb.forEach((region) => {\n                // increment/add ids to regions\n                regionID += 1;\n                region.id = regionID;\n                region.groupID = groupID;\n\n                let index = region.lcb_idx;\n                if (index in regions)\n                    regions[index].push(region);\n                else\n                    regions[index] = [region];\n            })\n        })\n\n        return {regions, regionCount: regionID, lcbCount: lcbID};\n    }\n\n    initControls() {\n        this.ele.querySelector('.opts-btn').onclick = () => {\n            this.ele.querySelector(\".dd-content\").classList.toggle(\"show\");\n        }\n\n        document.onclick = (evt) => {\n            let dd = this.ele.querySelector('.dropdown');\n            if (dd.contains(evt.target)) return;\n\n            if (!evt.target.matches('.dd-btn')) {\n                var dds = this.ele.getElementsByClassName(\"dd-content\");\n                Array.from(dds).forEach(dd => { dd.classList.remove('show') });\n            }\n        }\n    }\n\n}\n","\nimport {marginTop, trackOffset, ctrlPadding} from './consts';\n\n\nconst btnStyle = 'width: 26px; height: 23px;';\n\nexport class TrackCtrl {\n\n    constructor(params) {\n        this.id = params.id;\n\n        this.container = params.container;\n        this.svg = params.svg;\n        this.trackCount = params.trackCount;\n        this.yPos = params.yPos || marginTop + (this.id - 1) * trackOffset;\n\n        this.ctrls;\n        this.isReference = params.isReference || false;\n        this.hidden;\n\n\n        // control callbacks\n        this.onMoveUp = params.onMoveUp;\n        this.onMoveDown = params.onMoveDown;\n        this.onSetReference = params.onSetReference;\n        this.onHide = params.onHide;\n        this.onShow = params.onShow;\n\n        this.init();\n        return this;\n    }\n\n    init() {\n        this.destroy(); // don't allow more than one controller\n        this.render();\n    }\n\n    render() {\n        let mvPos = this.container.querySelector('.mauve-viewer').getBoundingClientRect(),\n            svgPos = this.svg.getBoundingClientRect(),\n            relativeTop = svgPos.top - mvPos.top;\n\n        // add container\n        let ele = this.node = document.createElement('div');\n        ele.setAttribute('class', `track-ctrl ctrl-${this.id}`);\n        //ele.style.border = \"1px solid black\";\n        ele.style.top = relativeTop  + this.yPos + ctrlPadding + 'px';\n        ele.style.left = '-35px';\n        ele.style.width = '25px';\n        ele.style.height = trackOffset + 'px';\n        ele.style.position = 'absolute';\n\n        this._addMainButtons();\n\n        this.container.querySelector('.mauve-viewer').appendChild(ele)\n    }\n\n    _addMainButtons() {\n        let {upBtn, downBtn, hideBtn, refBtn} = this.ctrls = this._getButtons();\n        this.node.appendChild(upBtn);\n        //this.node.appendChild(hideBtn);\n        this.node.appendChild(refBtn);\n        this.node.appendChild(downBtn);\n\n        if (this.isReference)\n            refBtn.classList.add('active');\n    }\n\n    _getButtons() {\n        let upBtn = document.createElement('button');\n        upBtn.title = 'Move this genome up';\n        upBtn.style = btnStyle;\n        upBtn.innerHTML = '';\n        upBtn.disabled = this.id === 1 || false;\n        upBtn.onclick = this.moveTrackUp.bind(this)\n\n        let hideBtn = document.createElement('button');\n        hideBtn.title = 'Hide this genome'\n        hideBtn.style = btnStyle;\n        hideBtn.innerHTML = '';\n        hideBtn.onclick = this.hideTrack.bind(this);\n\n        let refBtn = document.createElement('button');\n        refBtn.title = 'Set reference genome';\n        refBtn.classList.add('ref-btn');\n        refBtn.style = btnStyle;\n        refBtn.innerHTML = 'R';\n        refBtn.onclick = this.refTrack.bind(this);\n\n        let downBtn = document.createElement('button');\n        downBtn.title = 'Move this genome down';\n        downBtn.style = btnStyle;\n        downBtn.innerHTML = '';\n        downBtn.disabled = this.id === this.trackCount || false;\n        downBtn.onclick = this.moveTrackDown.bind(this);\n\n        return {upBtn, downBtn, hideBtn, refBtn}\n    }\n\n    _getShowButton() {\n        let showBtn = document.createElement('button');\n        showBtn.title = 'Show this genome';\n        showBtn.classList.add('show-btn');\n        showBtn.style = btnStyle;\n        showBtn.innerHTML = '+';\n        showBtn.onclick = this.showTrack.bind(this);\n        return showBtn;\n    }\n\n\n    moveTrackUp() {\n        this._selectNewRef(this.id, this.id - 1);\n        this.onMoveUp(this.id);\n    }\n\n    moveTrackDown() {\n        this._selectNewRef(this.id, this.id + 1);\n        this.onMoveDown(this.id);\n    }\n\n    hideTrack() {\n        this.node.innerHTML = '';\n        let showBtn = this._getShowButton();\n        this.node.appendChild(showBtn);\n\n        this.hidden = true;\n        this.onHide(this.id);\n    }\n\n    showTrack() {\n        console.log('called show');\n        this.node.innerHTML = '';\n        this._addMainButtons();\n\n        this.hidden = false;\n        this.onShow(this.id);\n    }\n\n    refTrack() {\n        let eles = this.container.querySelectorAll('.ref-btn');\n        eles.forEach(ele => { ele.classList.remove(\"active\"); });\n        this.ctrls.refBtn.classList.add('active');\n\n        this.onSetReference(this.id);\n        this.isReference = true;\n    }\n\n\n    _selectNewRef(oldID, newID) {\n        let oldCtrl = this.container.querySelector(`.ctrl-${oldID} .ref-btn`),\n            newCtrl = this.container.querySelector(`.ctrl-${newID} .ref-btn`);\n\n        let newCtrlWasActive;\n        if (newCtrl.classList.contains('active')) {\n            newCtrl.classList.remove('active');\n            oldCtrl.classList.add('active');\n            newCtrlWasActive = true;\n        }\n\n        if (oldCtrl.classList.contains('active') && !newCtrlWasActive) {\n            oldCtrl.classList.remove('active');\n            newCtrl.classList.add('active');\n        }\n    }\n\n\n    destroy() {\n        let node = this.container.querySelector(`.ctrl-${this.id}`);\n        if (node) node.remove();\n    }\n}\n","import {schemeCategory20} from './colors';\nimport {marginTop, trackOffset, yPosOffset, lcbHeight} from './consts';\n\n\nexport class Track {\n\n    constructor(params) {\n        this.d3 = params.d3;\n        this.svg = params.svg;\n\n        this.hidden = params.hidden;\n        this.id = params.id;\n        this.name = params.name;\n        this.label = params.label;\n        this.width = params.width;\n        this.xLength = params.xLength;\n        this.regions = params.regions;\n        this.yPos = params.yPos || marginTop + (this.id - 1) * trackOffset;\n\n        // render and expose axis/scale\n        this.x;\n        this.xAxis;\n        this.gX;\n        this.track;\n        this.render();\n\n        return this;\n    }\n\n    render() {\n        if (this.hidden) {\n            this.hiddenTrack();\n            return;\n        }\n\n        let d3 = this.d3;\n\n        this.x = d3.scaleLinear()\n            .domain([1, this.xLength])\n            .range([1, this.width + 1]);\n\n        this.xAxis = d3.axisBottom(this.x)\n            .ticks(5)\n            .tickSize(10)\n            .tickFormat(d3.format(\"d\"));\n\n        let g = this.track = this.svg.append('g')\n            .attr('class', d => `track id-${this.id}`)\n\n        this.gX = g.append(\"g\")\n            .attr('class', `axis axis-x-${this.id}`)\n            .call(this.xAxis)\n            .attr('transform', `translate(0, ${this.yPos})`);\n\n        // add names\n        g.append('text')\n            .attr('x', 0)\n            .attr('y', this.yPos + trackOffset - 5) // -2 padding\n            .text(this.label || this.name)\n            .attr('font-family', \"sans-serif\")\n            .attr('font-size', \"10px\")\n            .attr('fill', '#888');\n\n        if (this.regions)\n            this.addRegions(this.regions);\n    }\n\n    addRegions(regions) {\n        let numOfLCBs = regions.length;\n\n        // add regions\n        this.track.selectAll('rect')\n            .data(regions)\n            .enter()\n            .append('rect')\n            .attr('class', d => `region track-id-${this.id} group-${d.groupID} id-${d.id}`)\n            .attr('x', d => this.x(d.start))\n            .attr('y', d => this._getRegionYPos(this.id, d.strand))\n            .attr('width', d => this.x(d.end - d.start))\n            .attr('height', lcbHeight)\n            .attr('stroke', '#fffff')\n            .attr('fill', d =>  schemeCategory20[(d.groupID % numOfLCBs) % 20] )\n\n        this.regions = regions;\n    }\n\n    hiddenTrack() {\n        let g = this.track\n            .append('g')\n            .attr('class', d => `hidden-track`)\n\n        g.append('rect')\n            .attr('class', d => `hidden-track track-${this.id}`)\n            .attr('x', 0)\n            .attr('y', d => (this.id-1) * trackOffset )\n            .attr('width', d => 10000)\n            .attr('height', 20)\n            .attr('stroke', '#fffff')\n            .attr('fill', d =>  '#aaa')\n\n        g.append('text')\n            .attr('x', 10)\n            .attr('y', this.yPos - 2) // -2 padding\n            .text(this.label || this.name)\n            .attr(\"font-family\", \"sans-serif\")\n            .attr(\"font-size\", \"10px\")\n            .attr(\"fill\", '#222');\n    }\n\n    rescaleAxis() {\n        if (this.hidden) return;\n        this.gX.call(this.xAxis.scale(this.d3.event.transform.rescaleX(this.x)));\n    }\n\n    _getRegionYPos(trackIdx, strandDirection) {\n        return this.yPos + (strandDirection === '-' ? yPosOffset + lcbHeight : yPosOffset);\n    }\n}\n"],"sourceRoot":""}